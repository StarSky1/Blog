[pixiv: 022]: # 'https://cdn.jsdelivr.net/gh/starsky1/poi/2019/22.jpg'
## centos7安装mysql(Yum源方式)
1.下载mysql源安装包

$ wget http://dev.mysql.com/get/mysql57-community-release-el7-8.noarch.rpm
 
2.安装mysql源

`$ yum localinstall mysql57-community-release-el7-8.noarch.rpm `    
 
3.检查mysql源是否安装成功

`$ yum repolist enabled | grep "mysql.*-community.*"`
 
4.修改yum源 【可跳过】

`$ vim /etc/yum.repos.d/mysql-community.repo`

改变默认安装的mysql版本。比如要安装5.6版本，将5.7源的enabled=1改成enabled=0。然后再将5.6源的enabled=0改成enabled=1即可。

备注：enabled=1表示即将要安装的mysql版本，这个文件也可以不修改，默认安装mysql最高版本
![图一](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2201.png)

5.安装MySQL 

这一步才是真正安装mysql

`$ yum install mysql-community-server`
 
6.启动MySQL服务并设置开机启动

`$ systemctl start mysqld`

`$ systemctl enable mysqld`

`$ systemctl daemon-reload`
 
7.端口开放

`$ firewall-cmd --zone=public --add-port=3306/tcp --permanent`

`$ firewall-cmd --reload`

8.修改root本地登录密码

 1）查看mysql密码

`$ grep 'temporary password' /var/log/mysqld.log`
![图二](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2202.png)

2）连接mysql

`$ mysql -uroot -p`

3）修改密码【注意：后面的分号一定要跟上】

`mysql> ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!';`

或者：

`mysql> set password for 'root'@'localhost'=password('MyNewPass4!'); `
 
9.添加远程登录用户

`mysql> GRANT ALL PRIVILEGES ON *.* TO 'caoxiaobo'@'%' IDENTIFIED BY 'Caoxiaobo0917!' WITH GRANT OPTION;`

10.使用客户端连接测试

备注：这里的用户名是第9步设置的caoxiaobo，密码为：Caoxiaobo0917!
![图三](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2203.png)

![图四](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2204.png)

## ubuntu安装mysql(Apt方式)
首先执行下面四条命令：

`sudo apt-get update` #更新apt软件包管理器
`sudo apt-get install mysql-server`
`sudo apt install mysql-client`
`sudo apt install libmysqlclient-dev`

安装成功后可以通过下面的命令测试是否安装成功：

sudo netstat -tap | grep mysql

出现如下信息证明安装成功： 
![图五](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2205.png)

可以通过如下命令进入mysql服务：

`mysql -uroot -p 你的密码`

现在设置mysql允许远程访问，首先编辑文件/etc/mysql/mysql.conf.d/mysqld.cnf：

`sudo vi /etc/mysql/mysql.conf.d/mysqld.cnf`

注释掉bind-address = 127.0.0.1： 
![图六](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2206.png)

保存退出，然后进入mysql服务，执行远程访问权限授权命令：

`grant all on *.* to root@'%' identified by '你的密码' with grant option;`
`flush privileges;`

### 配置mysql默认字符集

在 /ect/mysql/my.cnf 中写入：
```
[client]
default-character-set = utf8
[mysqld]
character-set-server = utf8
[mysql]
default-character-set = utf8
```

然后执行quit命令退出mysql服务，执行如下命令重启mysql：

`sudo service mysql restart`

现在在windows下可以使用navicat远程连接ubuntu下的mysql服务。

## 使用mysql5.7-linux.tar.gz压缩包本地安装mysql5.7，适用于所有linux系统
### 第一步：下载
进入到mysql官网下载自己对应版本的mysql，

下载地址：https://dev.mysql.com/downloads/mysql/5.7.html#downloads

我这里下载mysql-5.7.25-linux-glibc2.12-x86_64.tar.gz版本
![图七](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2207.png)
也可以进入linux后用命令下载
```shell
wget https://cdn.mysql.com//Downloads/MySQL-5.7/mysql-5.7.25-linux-glibc2.12-x86_64.tar.gz
```
### 第二步：环境配置
linux连接工具：SecureCRT 8.1.4

linux文件管理工具：WinSCP 5.14.4

linux系统版本： CentOS 7.3 64位

安装源文件版本：mysql-5.7.25-linux-glibc2.12-x86_64.tar.gz

安装前，我们可以检测系统是否自带安装 MySQL:
```
rpm -qa | grep mysql
```
如有，类似
```
mysql-libs-5.1.52-1.el6_0.1.x86_64
```
那可以选择进行卸载:
```shell
rpm -e mysql-libs-5.1.52-1.el6_0.1.x86_64　　// 普通删除模式
rpm -e --nodeps mysql-libs-5.1.52-1.el6_0.1.x86_64　　// 强力删除模式，如果使用上面命令删除时，提示有依赖的其它文件，则用该命令可以对其进行强力删除
```

检查否存在 mariadb 数据库，如有，卸载之，卸载同上
```
rpm -qa | grep mariadb
```
如有，类似
```
mariadb-libs-5.5.56-2.el7.x86_64
```
则 卸载
```
rpm -e --nodeps mariadb-libs-5.5.56-2.el7.x86_64
```
用WinSCP 5.14.4工具将下载的mysql-5.7.25-linux-glibc2.12-x86_64.tar.gz上传到linux服务器的/opt/mysql目录下面
![图八](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2208.png)

### 第三步：安装
进入安装包所在目录，解压文件
```shell
cd /usr/local/mysql
tar -zxvf mysql-5.7.25-linux-glibc2.12-x86_64.tar.gz
```
![图九](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2209.png)
重命名
```
mv mysql-5.7.25-linux-glibc2.12-x86_64 mysql-5.7.25
```
#### 添加系统mysql组和mysql用户
检查mysql组和用户是否存在，如无创建
```shell
cat /etc/group | grep mysql
#类似
mysql:x:490:
cat /etc/passwd | grep mysql
#类似
mysql:x:496:490::/home/mysql:/bin/bash
```
以上为存在的情况，如无，执行添加命令：
```shell
groupadd mysql
useradd -r -g mysql mysql
 
#useradd -r参数表示mysql用户是系统用户，不可用于登录系统
```
![图十](https://cdn.jsdelivr.net/gh/starsky1/poi/2019/2210.png)

#### 安装数据库
创建data目录
```shell
cd mysql-5.7.25
mkdir data
```
将/usr/local/mysql/mysql-5.7.25的所有者及所属组改为mysql
```shell
chown -R mysql.mysql /usr/local/mysql/mysql-5.7.25
```
在/usr/local/mysql/mysql-5.7.25/support-files目录下创建my_default.cnf
```shell
# For advice on how to change settings please see
# http://dev.mysql.com/doc/refman/5.7/en/server-configuration-defaults.html
# *** DO NOT EDIT THIS FILE. It's a template which will be copied to the
# *** default location during install, and will be replaced if you
# *** upgrade to a newer version of MySQL.
 
 
[mysqld]
sql_mode=NO_ENGINE_SUBSTITUTION,STRICT_TRANS_TABLES 
 
basedir = /usr/local/mysql/mysql-5.7.25
datadir = /usr/local/mysql/mysql-5.7.25/data
port = 3306
socket = /tmp/mysql.sock
character-set-server=utf8
 
log-error = /usr/local/mysql/mysql-5.7.25/data/mysqld.log
pid-file = /usr/local/mysql/mysql-5.7.25/data/mysqld.pid
```
拷贝，如果提示是否覆盖，y
```
cp support-files/my_default.cnf /etc/my.cnf
```
初始化 mysqld
```
cd /usr/local/mysql/mysql-5.7.25
./bin/mysqld --initialize --user=mysql --basedir=/usr/local/mysql/mysql-5.7.25/ --datadir=/usr/local/mysql/mysql-5.7.25/data/ 
```
初始化完成之后，查看日志
```
cat /usr/local/mysql/mysql-5.7.25/data/mysqld.log
```
临时密码
```
2019-04-08T06:14:29.790033Z 1 [Note] A temporary password is generated for root@localhost: a8?DQir=T+k+
```
把启动脚本放到开机初始化目录
```
cp support-files/mysql.server /etc/init.d/mysql
```
启动mysql服务
```
service mysql start
```
登录mysql，密码为初始密码
```
mysql> set password=password('123456');
mysql> grant all privileges on *.* to root@'%' identified by '123456';
mysql> flush privileges;
```
添加远程访问权限 
```
mysql> use mysql;
mysql> update user set host='%' where user = 'root';
mysql> flush privileges;
mysql> exit;
```
重启mysql生效
```
service mysql stop
service mysql start
```
或
```
service mysql restart
```

## 转载文章
- [CentOS7 安装mysql（YUM源方式）](https://www.cnblogs.com/caoxb/p/9405323.html)
- [Ubuntu安装mysql](https://blog.csdn.net/mr_hui_/article/details/88878836)
- [ubuntu16安装mysql](https://www.jianshu.com/p/e01afad4b885)
- [linux下安装mysql-5.7.25详细步骤](https://blog.csdn.net/lch520baby/article/details/89081306)